#!/bin/bash

set -x

# Check script input
if [ "$#" -ne 1 ]; then
    echo "You must supply the location of the data parent directory " \
"(containing experiment_{1,3,8,12,14,16,18,19}) only"
    exit 1
fi
PARENTDIR=$(realpath "$1")

mkdir -p experiment_1
cd experiment_1
cat <<EOF > XDS.INP
MAXIMUM_NUMBER_OF_JOBS=4
MAXIMUM_NUMBER_OF_PROCESSORS=4
NAME_TEMPLATE_OF_DATA_FRAMES= $PARENTDIR/experiment_1/SMV/data/0????.img   SMV
DATA_RANGE=           1 125
SPOT_RANGE=           1 125
BACKGROUND_RANGE=     1 125
EXCLUDE_DATA_RANGE=20 20
EXCLUDE_DATA_RANGE=40 40
EXCLUDE_DATA_RANGE=60 60
EXCLUDE_DATA_RANGE=80 80
EXCLUDE_DATA_RANGE=100 100
EXCLUDE_DATA_RANGE=120 120
EXCLUDE_DATA_RANGE=140 140
EXCLUDE_DATA_RANGE=160 160
EXCLUDE_DATA_RANGE=180 180
EXCLUDE_DATA_RANGE=200 200
EXCLUDE_DATA_RANGE=220 220
EXCLUDE_DATA_RANGE=240 240
EXCLUDE_DATA_RANGE=260 260
EXCLUDE_DATA_RANGE=280 280
EXCLUDE_DATA_RANGE=300 300
EXCLUDE_DATA_RANGE=320 320
EXCLUDE_DATA_RANGE=340 340
EXCLUDE_DATA_RANGE=360 360
EXCLUDE_DATA_RANGE=380 380
EXCLUDE_DATA_RANGE=400 400
EXCLUDE_DATA_RANGE=420 420
EXCLUDE_DATA_RANGE=440 440
EXCLUDE_DATA_RANGE=460 460
EXCLUDE_DATA_RANGE=480 480
EXCLUDE_DATA_RANGE=500 500
EXCLUDE_DATA_RANGE=520 520
EXCLUDE_DATA_RANGE=540 540
EXCLUDE_DATA_RANGE=560 560
SPACE_GROUP_NUMBER= 4
UNIT_CELL_CONSTANTS= 12.403  8.097 13.685  90.000 111.935  90.000
FRIEDEL'S_LAW=TRUE
STARTING_ANGLE= -25.9
STARTING_FRAME= 1
NX=516  NY=516  QX=0.055  QY=0.055
OVERLOAD= 130000
TRUSTED_REGION= 0   1.4142
VALUE_RANGE_FOR_TRUSTED_DETECTOR_PIXELS= 200 300000
INCLUDE_RESOLUTION_RANGE= 20  0.9
DIRECTION_OF_DETECTOR_X-AXIS= 1 0 0
DIRECTION_OF_DETECTOR_Y-AXIS= 0 1 0
ORGX=225  ORGY=225
DETECTOR_DISTANCE= +439.4754
OSCILLATION_RANGE= 0.583
ROTATION_AXIS= -0.620 0.785 0.0000
X-RAY_WAVELENGTH= 0.0251
INCIDENT_BEAM_DIRECTION= 0 0 1
REFINE(IDXREF)= AXIS ORIENTATION CELL  BEAM  !POSITION BEAM AXIS       !ORIENTATION CELL !SEGMENT!
REFINE(INTEGRATE)= !POSITION BEAM AXIS       !ORIENTATION CELL
REFINE(CORRECT)= ORIENTATION CELL AXIS  BEAM  !POSITION BEAM AXIS ORIENTATION CELL        !SEGMENT
MINIMUM_FRACTION_OF_INDEXED_SPOTS= 0.25
REFLECTING_RANGE_E.S.D.= 0.16
NUMBER_OF_PROFILE_GRID_POINTS_ALONG_ALPHA/BETA=13
EOF
xds
cd ..

mkdir -p experiment_3
cd experiment_3
cat <<EOF > XDS.INP
MAXIMUM_NUMBER_OF_JOBS=4
MAXIMUM_NUMBER_OF_PROCESSORS=4
NAME_TEMPLATE_OF_DATA_FRAMES= $PARENTDIR/experiment_3/SMV/data/0????.img   SMV
DATA_RANGE=           14 145
SPOT_RANGE=           14 145
BACKGROUND_RANGE=     14 145
EXCLUDE_DATA_RANGE=20 20
EXCLUDE_DATA_RANGE=40 40
EXCLUDE_DATA_RANGE=60 60
EXCLUDE_DATA_RANGE=80 80
EXCLUDE_DATA_RANGE=100 100
EXCLUDE_DATA_RANGE=120 120
EXCLUDE_DATA_RANGE=140 140
EXCLUDE_DATA_RANGE=160 160
EXCLUDE_DATA_RANGE=180 180
EXCLUDE_DATA_RANGE=200 200
EXCLUDE_DATA_RANGE=220 220
EXCLUDE_DATA_RANGE=240 240
EXCLUDE_DATA_RANGE=260 260
EXCLUDE_DATA_RANGE=280 280
EXCLUDE_DATA_RANGE=300 300
EXCLUDE_DATA_RANGE=320 320
EXCLUDE_DATA_RANGE=340 340
EXCLUDE_DATA_RANGE=360 360
EXCLUDE_DATA_RANGE=380 380
EXCLUDE_DATA_RANGE=400 400
EXCLUDE_DATA_RANGE=420 420
EXCLUDE_DATA_RANGE=440 440
EXCLUDE_DATA_RANGE=460 460
EXCLUDE_DATA_RANGE=480 480
EXCLUDE_DATA_RANGE=500 500
EXCLUDE_DATA_RANGE=520 520
EXCLUDE_DATA_RANGE=540 540
EXCLUDE_DATA_RANGE=560 560
SPACE_GROUP_NUMBER= 4
UNIT_CELL_CONSTANTS= 12.403  8.097 13.685  90.000 111.935  90.000
FRIEDEL'S_LAW=TRUE
STARTING_ANGLE= -25.9
STARTING_FRAME= 1
NX=516  NY=516  QX=0.055  QY=0.055
OVERLOAD= 130000
TRUSTED_REGION= 0   1.4142
VALUE_RANGE_FOR_TRUSTED_DETECTOR_PIXELS= 200 300000
INCLUDE_RESOLUTION_RANGE= 20  0.9
DIRECTION_OF_DETECTOR_X-AXIS= 1 0 0
DIRECTION_OF_DETECTOR_Y-AXIS= 0 1 0
ORGX=225  ORGY=225
DETECTOR_DISTANCE= +439.4754
OSCILLATION_RANGE= 0.579
ROTATION_AXIS= -0.620 0.785 0.0000
X-RAY_WAVELENGTH= 0.0251
INCIDENT_BEAM_DIRECTION= 0 0 1
REFINE(IDXREF)= AXIS ORIENTATION CELL  BEAM  !POSITION BEAM AXIS       !ORIENTATION CELL !SEGMENT!
REFINE(INTEGRATE)= !POSITION BEAM AXIS       !ORIENTATION CELL
REFINE(CORRECT)= ORIENTATION CELL AXIS  BEAM  !POSITION BEAM AXIS ORIENTATION CELL        !SEGMENT
MINIMUM_FRACTION_OF_INDEXED_SPOTS= 0.25
REFLECTING_RANGE_E.S.D.= 0.19
NUMBER_OF_PROFILE_GRID_POINTS_ALONG_ALPHA/BETA=13
EOF
xds
cd ..

mkdir -p experiment_8
cd experiment_8
cat <<EOF > XDS.INP
MAXIMUM_NUMBER_OF_JOBS=4
MAXIMUM_NUMBER_OF_PROCESSORS=4
NAME_TEMPLATE_OF_DATA_FRAMES= $PARENTDIR/experiment_8/SMV/data/0????.img   SMV
DATA_RANGE=           1 155
SPOT_RANGE=           1 155
BACKGROUND_RANGE=     1 155
EXCLUDE_DATA_RANGE=20 20
EXCLUDE_DATA_RANGE=40 40
EXCLUDE_DATA_RANGE=60 60
EXCLUDE_DATA_RANGE=80 80
EXCLUDE_DATA_RANGE=100 100
EXCLUDE_DATA_RANGE=120 120
EXCLUDE_DATA_RANGE=140 140
EXCLUDE_DATA_RANGE=160 160
EXCLUDE_DATA_RANGE=180 180
EXCLUDE_DATA_RANGE=200 200
EXCLUDE_DATA_RANGE=220 220
EXCLUDE_DATA_RANGE=240 240
EXCLUDE_DATA_RANGE=260 260
EXCLUDE_DATA_RANGE=280 280
EXCLUDE_DATA_RANGE=300 300
EXCLUDE_DATA_RANGE=320 320
EXCLUDE_DATA_RANGE=340 340
EXCLUDE_DATA_RANGE=360 360
EXCLUDE_DATA_RANGE=380 380
EXCLUDE_DATA_RANGE=400 400
EXCLUDE_DATA_RANGE=420 420
EXCLUDE_DATA_RANGE=440 440
EXCLUDE_DATA_RANGE=460 460
EXCLUDE_DATA_RANGE=480 480
EXCLUDE_DATA_RANGE=500 500
EXCLUDE_DATA_RANGE=520 520
EXCLUDE_DATA_RANGE=540 540
EXCLUDE_DATA_RANGE=560 560
SPACE_GROUP_NUMBER= 4
UNIT_CELL_CONSTANTS= 12.403  8.097 13.685  90.000 111.935  90.000
FRIEDEL'S_LAW=TRUE
STARTING_ANGLE= -25.9
STARTING_FRAME= 1
NX=516  NY=516  QX=0.055  QY=0.055
OVERLOAD= 130000
TRUSTED_REGION= 0   1.4142
VALUE_RANGE_FOR_TRUSTED_DETECTOR_PIXELS= 200 300000
INCLUDE_RESOLUTION_RANGE= 20  0.9
DIRECTION_OF_DETECTOR_X-AXIS= 1 0 0
DIRECTION_OF_DETECTOR_Y-AXIS= 0 1 0
ORGX=229  ORGY=224
DETECTOR_DISTANCE= +510.2773
OSCILLATION_RANGE= 0.5794
ROTATION_AXIS= -0.620 0.785 0.0000
X-RAY_WAVELENGTH= 0.0251
INCIDENT_BEAM_DIRECTION= 0 0 1
REFINE(IDXREF)= AXIS ORIENTATION CELL  BEAM  !POSITION BEAM AXIS       !ORIENTATION CELL !SEGMENT!
REFINE(INTEGRATE)= !POSITION BEAM AXIS       !ORIENTATION CELL
REFINE(CORRECT)= ORIENTATION CELL AXIS  BEAM  !POSITION BEAM AXIS ORIENTATION CELL        !SEGMENT
MINIMUM_FRACTION_OF_INDEXED_SPOTS= 0.25
REFLECTING_RANGE_E.S.D.= 0.1
NUMBER_OF_PROFILE_GRID_POINTS_ALONG_ALPHA/BETA=13
EOF
xds
cd ..

mkdir -p experiment_12
cd experiment_12
cat <<EOF > XDS.INP
MAXIMUM_NUMBER_OF_JOBS=4
MAXIMUM_NUMBER_OF_PROCESSORS=4
NAME_TEMPLATE_OF_DATA_FRAMES= $PARENTDIR/experiment_12/SMV/data/0????.img   SMV
DATA_RANGE=           1 121
SPOT_RANGE=           1 121
BACKGROUND_RANGE=     1 121
EXCLUDE_DATA_RANGE=20 20
EXCLUDE_DATA_RANGE=40 40
EXCLUDE_DATA_RANGE=60 60
EXCLUDE_DATA_RANGE=80 80
EXCLUDE_DATA_RANGE=100 100
EXCLUDE_DATA_RANGE=120 120
EXCLUDE_DATA_RANGE=140 140
EXCLUDE_DATA_RANGE=160 160
EXCLUDE_DATA_RANGE=180 180
EXCLUDE_DATA_RANGE=200 200
EXCLUDE_DATA_RANGE=220 220
EXCLUDE_DATA_RANGE=240 240
EXCLUDE_DATA_RANGE=260 260
EXCLUDE_DATA_RANGE=280 280
EXCLUDE_DATA_RANGE=300 300
EXCLUDE_DATA_RANGE=320 320
EXCLUDE_DATA_RANGE=340 340
EXCLUDE_DATA_RANGE=360 360
EXCLUDE_DATA_RANGE=380 380
EXCLUDE_DATA_RANGE=400 400
EXCLUDE_DATA_RANGE=420 420
EXCLUDE_DATA_RANGE=440 440
EXCLUDE_DATA_RANGE=460 460
EXCLUDE_DATA_RANGE=480 480
EXCLUDE_DATA_RANGE=500 500
EXCLUDE_DATA_RANGE=520 520
EXCLUDE_DATA_RANGE=540 540
EXCLUDE_DATA_RANGE=560 560
SPACE_GROUP_NUMBER= 4
UNIT_CELL_CONSTANTS= 12.403  8.097 13.685  90.000 111.935  90.000
FRIEDEL'S_LAW=TRUE
STARTING_ANGLE= -25.9
STARTING_FRAME= 1
NX=516  NY=516  QX=0.055  QY=0.055
OVERLOAD= 130000
TRUSTED_REGION= 0   1.4142
VALUE_RANGE_FOR_TRUSTED_DETECTOR_PIXELS= 200 300000
INCLUDE_RESOLUTION_RANGE= 20  0.9
DIRECTION_OF_DETECTOR_X-AXIS= 1 0 0
DIRECTION_OF_DETECTOR_Y-AXIS= 0 1 0
ORGX=229  ORGY=224
DETECTOR_DISTANCE= +510.2773
OSCILLATION_RANGE= 0.5756
ROTATION_AXIS= -0.620 0.785 0.0000
X-RAY_WAVELENGTH= 0.0251
INCIDENT_BEAM_DIRECTION= 0 0 1
REFINE(IDXREF)= AXIS ORIENTATION CELL  BEAM  !POSITION BEAM AXIS       !ORIENTATION CELL !SEGMENT!
REFINE(INTEGRATE)= !POSITION BEAM AXIS       !ORIENTATION CELL
REFINE(CORRECT)= ORIENTATION CELL AXIS  BEAM  !POSITION BEAM AXIS ORIENTATION CELL        !SEGMENT
MINIMUM_FRACTION_OF_INDEXED_SPOTS= 0.25
REFLECTING_RANGE_E.S.D.= 0.1
NUMBER_OF_PROFILE_GRID_POINTS_ALONG_ALPHA/BETA=13
EOF
xds
cd ..

mkdir -p experiment_14
cd experiment_14
cat <<EOF > XDS.INP
MAXIMUM_NUMBER_OF_JOBS=4
MAXIMUM_NUMBER_OF_PROCESSORS=4
NAME_TEMPLATE_OF_DATA_FRAMES= $PARENTDIR/experiment_14/SMV/data/0????.img   SMV
DATA_RANGE=           1 119
SPOT_RANGE=           1 119
BACKGROUND_RANGE=     1 119
EXCLUDE_DATA_RANGE=20 20
EXCLUDE_DATA_RANGE=40 40
EXCLUDE_DATA_RANGE=60 60
EXCLUDE_DATA_RANGE=80 80
EXCLUDE_DATA_RANGE=100 100
EXCLUDE_DATA_RANGE=120 120
EXCLUDE_DATA_RANGE=140 140
EXCLUDE_DATA_RANGE=160 160
EXCLUDE_DATA_RANGE=180 180
EXCLUDE_DATA_RANGE=200 200
EXCLUDE_DATA_RANGE=220 220
EXCLUDE_DATA_RANGE=240 240
EXCLUDE_DATA_RANGE=260 260
EXCLUDE_DATA_RANGE=280 280
EXCLUDE_DATA_RANGE=300 300
EXCLUDE_DATA_RANGE=320 320
EXCLUDE_DATA_RANGE=340 340
EXCLUDE_DATA_RANGE=360 360
EXCLUDE_DATA_RANGE=380 380
EXCLUDE_DATA_RANGE=400 400
EXCLUDE_DATA_RANGE=420 420
EXCLUDE_DATA_RANGE=440 440
EXCLUDE_DATA_RANGE=460 460
EXCLUDE_DATA_RANGE=480 480
EXCLUDE_DATA_RANGE=500 500
EXCLUDE_DATA_RANGE=520 520
EXCLUDE_DATA_RANGE=540 540
EXCLUDE_DATA_RANGE=560 560
SPACE_GROUP_NUMBER= 4
UNIT_CELL_CONSTANTS= 12.403  8.097 13.685  90.000 111.935  90.000
FRIEDEL'S_LAW=TRUE
STARTING_ANGLE= -25.9
STARTING_FRAME= 1
NX=516  NY=516  QX=0.055  QY=0.055
OVERLOAD= 130000
TRUSTED_REGION= 0   1.4142
VALUE_RANGE_FOR_TRUSTED_DETECTOR_PIXELS= 200 300000
INCLUDE_RESOLUTION_RANGE= 20  0.85
DIRECTION_OF_DETECTOR_X-AXIS= 1 0 0
DIRECTION_OF_DETECTOR_Y-AXIS= 0 1 0
ORGX=229  ORGY=224
DETECTOR_DISTANCE= +510.2773
OSCILLATION_RANGE= 0.5856
ROTATION_AXIS= -0.620 0.785 0.0000
X-RAY_WAVELENGTH= 0.0251
INCIDENT_BEAM_DIRECTION= 0 0 1
REFINE(IDXREF)= AXIS ORIENTATION CELL  BEAM  !POSITION BEAM AXIS       !ORIENTATION CELL !SEGMENT!
REFINE(INTEGRATE)= !POSITION BEAM AXIS       !ORIENTATION CELL
REFINE(CORRECT)= ORIENTATION CELL AXIS  BEAM  !POSITION BEAM AXIS ORIENTATION CELL        !SEGMENT
MINIMUM_FRACTION_OF_INDEXED_SPOTS= 0.25
REFLECTING_RANGE_E.S.D.= 0.1
NUMBER_OF_PROFILE_GRID_POINTS_ALONG_ALPHA/BETA=13
EOF
xds
cd ..

mkdir -p experiment_16
cd experiment_16
cat <<EOF > XDS.INP
MAXIMUM_NUMBER_OF_JOBS=4
MAXIMUM_NUMBER_OF_PROCESSORS=4
NAME_TEMPLATE_OF_DATA_FRAMES= $PARENTDIR/experiment_16/SMV/data/0????.img   SMV
DATA_RANGE=           1 82
SPOT_RANGE=           1 82
BACKGROUND_RANGE=     1 82
EXCLUDE_DATA_RANGE=20 20
EXCLUDE_DATA_RANGE=40 40
EXCLUDE_DATA_RANGE=60 60
EXCLUDE_DATA_RANGE=80 80
EXCLUDE_DATA_RANGE=100 100
EXCLUDE_DATA_RANGE=120 120
EXCLUDE_DATA_RANGE=140 140
EXCLUDE_DATA_RANGE=160 160
EXCLUDE_DATA_RANGE=180 180
EXCLUDE_DATA_RANGE=200 200
EXCLUDE_DATA_RANGE=220 220
EXCLUDE_DATA_RANGE=240 240
EXCLUDE_DATA_RANGE=260 260
EXCLUDE_DATA_RANGE=280 280
EXCLUDE_DATA_RANGE=300 300
EXCLUDE_DATA_RANGE=320 320
EXCLUDE_DATA_RANGE=340 340
EXCLUDE_DATA_RANGE=360 360
EXCLUDE_DATA_RANGE=380 380
EXCLUDE_DATA_RANGE=400 400
EXCLUDE_DATA_RANGE=420 420
EXCLUDE_DATA_RANGE=440 440
EXCLUDE_DATA_RANGE=460 460
EXCLUDE_DATA_RANGE=480 480
EXCLUDE_DATA_RANGE=500 500
EXCLUDE_DATA_RANGE=520 520
EXCLUDE_DATA_RANGE=540 540
EXCLUDE_DATA_RANGE=560 560
SPACE_GROUP_NUMBER= 4
UNIT_CELL_CONSTANTS= 12.403  8.097 13.685  90.000 111.935  90.000
FRIEDEL'S_LAW=TRUE
STARTING_ANGLE= -25.9
STARTING_FRAME= 1
NX=516  NY=516  QX=0.055  QY=0.055
OVERLOAD= 130000
TRUSTED_REGION= 0   1.4142
VALUE_RANGE_FOR_TRUSTED_DETECTOR_PIXELS= 200 300000
INCLUDE_RESOLUTION_RANGE= 20  0.9
DIRECTION_OF_DETECTOR_X-AXIS= 1 0 0
DIRECTION_OF_DETECTOR_Y-AXIS= 0 1 0
ORGX=225  ORGY=225
DETECTOR_DISTANCE= +439.4754
OSCILLATION_RANGE= 0.583
ROTATION_AXIS= -0.620 0.785 0.0000
X-RAY_WAVELENGTH= 0.0251
INCIDENT_BEAM_DIRECTION= 0 0 1
REFINE(IDXREF)= AXIS ORIENTATION CELL  BEAM  !POSITION BEAM AXIS       !ORIENTATION CELL !SEGMENT!
REFINE(INTEGRATE)= !POSITION BEAM AXIS       !ORIENTATION CELL
REFINE(CORRECT)= ORIENTATION CELL AXIS  BEAM  !POSITION BEAM AXIS ORIENTATION CELL        !SEGMENT
MINIMUM_FRACTION_OF_INDEXED_SPOTS= 0.25
REFLECTING_RANGE_E.S.D.= 0.31
NUMBER_OF_PROFILE_GRID_POINTS_ALONG_ALPHA/BETA=13
EOF
xds
cd ..

mkdir -p experiment_18
cd experiment_18
cat <<EOF > XDS.INP
MAXIMUM_NUMBER_OF_JOBS=4
MAXIMUM_NUMBER_OF_PROCESSORS=4
NAME_TEMPLATE_OF_DATA_FRAMES= $PARENTDIR/experiment_18/SMV/data/0????.img   SMV
DATA_RANGE=           1 135
SPOT_RANGE=           1 135
BACKGROUND_RANGE=     1 135
EXCLUDE_DATA_RANGE=20 20
EXCLUDE_DATA_RANGE=40 40
EXCLUDE_DATA_RANGE=60 60
EXCLUDE_DATA_RANGE=80 80
EXCLUDE_DATA_RANGE=100 100
EXCLUDE_DATA_RANGE=120 120
EXCLUDE_DATA_RANGE=140 140
EXCLUDE_DATA_RANGE=160 160
EXCLUDE_DATA_RANGE=180 180
EXCLUDE_DATA_RANGE=200 200
EXCLUDE_DATA_RANGE=220 220
EXCLUDE_DATA_RANGE=240 240
EXCLUDE_DATA_RANGE=260 260
EXCLUDE_DATA_RANGE=280 280
EXCLUDE_DATA_RANGE=300 300
EXCLUDE_DATA_RANGE=320 320
EXCLUDE_DATA_RANGE=340 340
EXCLUDE_DATA_RANGE=360 360
EXCLUDE_DATA_RANGE=380 380
EXCLUDE_DATA_RANGE=400 400
EXCLUDE_DATA_RANGE=420 420
EXCLUDE_DATA_RANGE=440 440
EXCLUDE_DATA_RANGE=460 460
EXCLUDE_DATA_RANGE=480 480
EXCLUDE_DATA_RANGE=500 500
EXCLUDE_DATA_RANGE=520 520
EXCLUDE_DATA_RANGE=540 540
EXCLUDE_DATA_RANGE=560 560
SPACE_GROUP_NUMBER= 4
UNIT_CELL_CONSTANTS= 12.403  8.097 13.685  90.000 111.935  90.000
FRIEDEL'S_LAW=TRUE
STARTING_ANGLE= -25.9
STARTING_FRAME= 1
NX=516  NY=516  QX=0.055  QY=0.055
OVERLOAD= 130000
TRUSTED_REGION= 0   1.4142
VALUE_RANGE_FOR_TRUSTED_DETECTOR_PIXELS= 200 300000
INCLUDE_RESOLUTION_RANGE= 20  0.9
DIRECTION_OF_DETECTOR_X-AXIS= 1 0 0
DIRECTION_OF_DETECTOR_Y-AXIS= 0 1 0
ORGX=225  ORGY=225
DETECTOR_DISTANCE= +439.4754
OSCILLATION_RANGE= 0.580
ROTATION_AXIS= -0.620 0.785 0.0000
X-RAY_WAVELENGTH= 0.0251
INCIDENT_BEAM_DIRECTION= 0 0 1
REFINE(IDXREF)= AXIS ORIENTATION CELL  BEAM  !POSITION BEAM AXIS       !ORIENTATION CELL !SEGMENT!
REFINE(INTEGRATE)= !POSITION BEAM AXIS       !ORIENTATION CELL
REFINE(CORRECT)= ORIENTATION CELL AXIS  BEAM  !POSITION BEAM AXIS ORIENTATION CELL        !SEGMENT
MINIMUM_FRACTION_OF_INDEXED_SPOTS= 0.25
NUMBER_OF_PROFILE_GRID_POINTS_ALONG_ALPHA/BETA=13
EOF
xds
cd ..

mkdir -p experiment_19
cd experiment_19
cat <<EOF > XDS.INP
MAXIMUM_NUMBER_OF_JOBS=4
MAXIMUM_NUMBER_OF_PROCESSORS=4
NAME_TEMPLATE_OF_DATA_FRAMES= $PARENTDIR/experiment_19/SMV/data/0????.img   SMV
DATA_RANGE=           1 124
SPOT_RANGE=           1 124
BACKGROUND_RANGE=     1 124
EXCLUDE_DATA_RANGE=20 20
EXCLUDE_DATA_RANGE=40 40
EXCLUDE_DATA_RANGE=60 60
EXCLUDE_DATA_RANGE=80 80
EXCLUDE_DATA_RANGE=100 100
EXCLUDE_DATA_RANGE=120 120
EXCLUDE_DATA_RANGE=140 140
EXCLUDE_DATA_RANGE=160 160
EXCLUDE_DATA_RANGE=180 180
EXCLUDE_DATA_RANGE=200 200
EXCLUDE_DATA_RANGE=220 220
EXCLUDE_DATA_RANGE=240 240
EXCLUDE_DATA_RANGE=260 260
EXCLUDE_DATA_RANGE=280 280
EXCLUDE_DATA_RANGE=300 300
EXCLUDE_DATA_RANGE=320 320
EXCLUDE_DATA_RANGE=340 340
EXCLUDE_DATA_RANGE=360 360
EXCLUDE_DATA_RANGE=380 380
EXCLUDE_DATA_RANGE=400 400
EXCLUDE_DATA_RANGE=420 420
EXCLUDE_DATA_RANGE=440 440
EXCLUDE_DATA_RANGE=460 460
EXCLUDE_DATA_RANGE=480 480
EXCLUDE_DATA_RANGE=500 500
EXCLUDE_DATA_RANGE=520 520
EXCLUDE_DATA_RANGE=540 540
EXCLUDE_DATA_RANGE=560 560
SPACE_GROUP_NUMBER= 4
UNIT_CELL_CONSTANTS= 12.403  8.097 13.685  90.000 111.935  90.000
FRIEDEL'S_LAW=TRUE
STARTING_ANGLE= -25.9
STARTING_FRAME= 1
NX=516  NY=516  QX=0.055  QY=0.055
OVERLOAD= 130000
TRUSTED_REGION= 0   1.4142
VALUE_RANGE_FOR_TRUSTED_DETECTOR_PIXELS= 200 300000
INCLUDE_RESOLUTION_RANGE= 20  0.9
DIRECTION_OF_DETECTOR_X-AXIS= 1 0 0
DIRECTION_OF_DETECTOR_Y-AXIS= 0 1 0
ORGX=225  ORGY=225
DETECTOR_DISTANCE= +439.4754
OSCILLATION_RANGE= 0.583
ROTATION_AXIS= -0.620 0.785 0.0000
X-RAY_WAVELENGTH= 0.0251
INCIDENT_BEAM_DIRECTION= 0 0 1
REFINE(IDXREF)= AXIS ORIENTATION CELL  BEAM  !POSITION BEAM AXIS       !ORIENTATION CELL !SEGMENT!
REFINE(INTEGRATE)= !POSITION BEAM AXIS       !ORIENTATION CELL
REFINE(CORRECT)= ORIENTATION CELL AXIS  BEAM  !POSITION BEAM AXIS ORIENTATION CELL        !SEGMENT
MINIMUM_FRACTION_OF_INDEXED_SPOTS= 0.25
REFLECTING_RANGE_E.S.D.= 0.175
NUMBER_OF_PROFILE_GRID_POINTS_ALONG_ALPHA/BETA=13
EOF
xds
cd ..


mkdir -p solve
cd solve/
cat <<EOF > XSCALE.INP
OUTPUT_FILE=temp.ahkl
INPUT_FILE=../experiment_1/XDS_ASCII.HKL
INPUT_FILE=../experiment_3/XDS_ASCII.HKL
INPUT_FILE=../experiment_8/XDS_ASCII.HKL
INPUT_FILE=../experiment_12/XDS_ASCII.HKL
INPUT_FILE=../experiment_14/XDS_ASCII.HKL
INPUT_FILE=../experiment_16/XDS_ASCII.HKL
INPUT_FILE=../experiment_18/XDS_ASCII.HKL
INPUT_FILE=../experiment_19/XDS_ASCII.HKL
EOF
xscale

cat <<EOF > XDSCONV.INP
INPUT_FILE=temp.ahkl
OUTPUT_FILE=xds.hkl  SHELX
FRIEDEL'S_LAW=FALSE
EOF
xdsconv

cat <<+ > xds.ins
TITL P2
CELL 0.0251 12.403  8.097 13.685  90.000 111.935  90.000
ZERR 1.00    0.000  0.000  0.000   0.000   0.000   0.000
LATT -1
SYMM -X,Y,-Z
SFAC C   0.7307 36.9951  1.1951 11.2966         =
         0.4563  2.8139  0.1247  0.3456  0.0000 =
         0.0000  0.0000  0.0000  0.7700 12.0107
SFAC O   0.4548 23.7803  0.9173  7.6220         =
         0.4719  2.1440  0.1384  0.2959  0.0000 =
         0.0000  0.0000  0.0000  0.7300 15.9990
SFAC H   0.3754 15.4946  0.1408  4.1261         =
         0.0216  0.0246 -0.1012 46.8840  0.0000 =
         0.0000  0.0000  0.0000  0.3200  1.0080
UNIT 26 4 36
TREF 5000
HKLF 4
END
+
shelxt xds > shelxt.log
cd ..
